# HYPER-TENSOR PROTOCOL (HTP): Core Protocol Specification
"The Soul evolves, the Will optimizes, the Body manifests."

## Abstract
This document defines the Hyper-Tensor Protocol (HTP). The protocol establishes an algebraic evolution mechanism based on the Ideal Class Group of Imaginary Quadratic Fields for the generation, verification, and materialization of logical paths.
**Core Transformation:**
The system transitions from a "continuous manifold approximation" to a rigorous Discrete Algebraic Graph Search. Truth is the zero-energy state found by traversing the Cayley Graph of the class group.

---

## 1. The Soul: Discrete Algebraic State Space
### 1.1 The Structure: Finite Abelian Group $Cl(\Delta)$
The core state space is not a continuous manifold, but a finite discrete Abelian group: the Ideal Class Group $Cl(\Delta)$.
**Discriminant:** $$\Delta < 0$$
and
$$\Delta \equiv 0, 1 \pmod 4$$
**Elements:** Equivalence classes of binary quadratic forms $[a, b, c]$.
**Topology:** Discrete topology. No intrinsic notion of "infinitesimal" exists naturally.

### 1.2 The Geometry: Cayley Graph
To define "neighborhoods" and "search directions" for the Will, we explicitly construct a Cayley Graph $\mathcal{G}$.
**Vertices:** Elements of $Cl(\Delta)$.
**Generating Set ($\mathcal{P}$):** A selected set of prime ideal classes (perturbations) generated by the VAPO perturber.
$$\mathcal{P} = \{ [\mathfrak{p}_1], [\mathfrak{p}_1]^{-1}, \dots, [\mathfrak{p}_k], [\mathfrak{p}_k]^{-1} \}$$
**Metric:** The distance $d(S_1, S_2)$ is defined as the Word Metric relative to $\mathcal{P}$ — the length of the shortest path between $S_1$ and $S_2$ on the graph.

### 1.3 State Evolution Dynamics (Decoupled)
**Correction (v2.1):** To preserve the Lipschitz metric structure required for optimization, we strictly decouple the Search Dynamics from the Time Dynamics.

1. **Search Dynamics (The Will's Walk):**
The Will operates on the static Cayley Graph. It moves from neighbor to neighbor to find the optimal seed. This process does not involve squaring (Time Evolution), ensuring that the search space metric remains stable.
$$S_{k+1} = S_k \circ \epsilon_k$$
$S_k$: The current candidate seed at search step $k$.
$\epsilon_k \in \mathcal{P}$: A perturbation (generator) chosen by the VAPO optimizer.

2. **Time Dynamics (The Observation):**
Once a candidate seed $S$ is selected (or evaluated), it is "unfolded" in time to generate the logical path. This is the VDF (Verifiable Delay Function) aspect.
$$O_0 = S$$
$$O_{t+1} = O_t^2$$
The logical path is derived from the orbit $O_0, O_1, \dots, O_T$.

---

## 2. The Will: Discrete Graph Search
### 2.1 The Optimization Objective
The responsibility of the Will is to navigate the Cayley Graph to find a node $S^*$ such that the projected logical path satisfies zero energy.
$$\text{Minimize } E_{STP}(\Psi(S))$$
$$\text{subject to } S \in V(\mathcal{G})$$

### 2.2 VAPO on Graphs
Since gradients $\nabla J$ are undefined on a discrete graph, VAPO (Valuation-Adaptive Perturbation Optimization) operates as a Heuristic Search.
**The "Valuation" Heuristic:**
The efficacy of VAPO relies strictly on the Lipschitz continuity of the Projection Map $\Psi$. Small steps in the graph must result in bounded changes in the logical output.

* **Coarse Operators (Large Norm Primes):** Edges in $\mathcal{G}$ that correspond to generators with large algebraic norms. These tend to cause larger shifts in the modulo projection.
* **Fine Operators (Small Norm Primes):** Edges corresponding to small norm primes. These act as "local" adjustments.

---

## 3. The Body: Topological Materialization (v2.1 Upgrade)
### 3.1 The Problem of Reduction Chaos (Deprecation Notice)
Previous versions utilized Linear Congruence Projection (LCP): $\Psi(S) = (a + kb) \pmod P$.
While computationally cheap, LCP suffers from **Reduction Chaos**. The Gaussian reduction of quadratic forms is not Lipschitz continuous with respect to the coefficients $(a, b)$. Small perturbations in the ideal class can cause the reduced basis $(a, b)$ to undergo large, discontinuous jumps (flips) across the fundamental domain boundary. This destroys the local gradient information required by VAPO.

### 3.2 Canonical Modular Projection ($\tau$-Feature)
To restore Lipschitz continuity and ensure a smooth energy landscape, we introduce the Modular Feature Projection. Instead of projecting the raw coefficients, we project the geometric invariants of the ideal class in the Upper Half Plane $\mathbb{H}$.
**The Modular Point:**
For a reduced form $[a, b, c]$, the corresponding point in $\mathbb{H}$ is:
$$\tau = \frac{-b + i\sqrt{|\Delta|}}{2a} = x + iy$$

**The Feature Vector:**
To handle the modular symmetry (identifications under $SL_2(\mathbb{Z})$), specifically the translation symmetry $\tau \mapsto \tau + 1$, we map the components to a cylindrical manifold:
$$\mathbf{F}(S) = \begin{bmatrix} \cos(2\pi x) \\ \sin(2\pi x) \\ \log(y) \end{bmatrix}$$
* **$\cos/\sin$:** Eliminates the discontinuity caused by integer shifts in $x$ during reduction.
* **$\log(y)$:** Compresses the multiplicative scale of the norm (height) into an additive linear scale, providing a convex-like landscape for optimization.

### 3.3 Discrete Materialization
While the Will optimizes on the continuous manifold defined by $\mathbf{F}(S)$, the Body must ultimately output discrete logical symbols.
**Bucketing & Hashing:**
The continuous feature vector is discretized into a grid (bucketing) and then deterministically hashed to the output space $\mathbb{Z}_p$.
$$\Psi(S) = \text{Hash}(\text{Bucket}(\mathbf{F}(S))) \pmod P$$
This two-stage process ensures:
1.  **Optimization Stability:** The Will sees a smooth gradient via $\mathbf{F}(S)$.
2.  **Logical Rigor:** The output logic remains discrete and deterministic.

---

## 4. Security & Verifiability
### 4.1 Time Security (Hidden Path)
Security relies on the hardness of the Shortest Path Problem (or DLP) in the huge Cayley Graph of $Cl(\Delta)$. Finding the specific sequence of generators (the path) that connects $S_0$ to $S_{final}$ is computationally infeasible without the history.

### 4.2 Proof of Will
The Proof Bundle is the Path Record:
```text
Bundle = { ContextHash, S_final, Path = [ε_1, ε_2, ..., ε_k] }
```
Verification involves replaying the walk on the graph:
$$S_0 \xrightarrow{\epsilon_1} S_1 \dots \xrightarrow{\epsilon_k} S_{final}$$

---

## 5. Conclusion
HTP is re-specified as:
* **Soul:** A node in the Class Group Cayley Graph.
* **Will:** An agent performing heuristic search on the smooth Modular Feature Manifold.
* **Body:** The discrete quantization of the modular features.

No reduction chaos, just rigorous modular geometry.
